<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Blog - P-Dhanush</title>
<meta name="description" content="">



<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="P-Dhanush">
<meta property="og:title" content="Blog">
<meta property="og:url" content="https://p-dhanush.github.io/">













<link rel="canonical" href="https://p-dhanush.github.io/">





  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
    "name": null,
    "url": "https://p-dhanush.github.io/"
}
</script>









<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="P-Dhanush Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script type="text/javascript">
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--custom_home">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          P-Dhanush
          
        </a>
        <ul class="visible-links"></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      <!doctype html>
<html lang="en" data-theme="auto">

<head>
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Blog | P-Dhanush</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Blog" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://p-dhanush.github.io/" />
<meta property="og:url" content="https://p-dhanush.github.io/" />
<meta property="og:site_name" content="P-Dhanush" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Blog" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","headline":"Blog","name":"P-Dhanush","url":"https://p-dhanush.github.io/"}</script>
<!-- End Jekyll SEO tag -->

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Blog | P-Dhanush</title>

    <style>
        /* Light (default) */
        :root {
            --fg: #111;
            --muted: #666;
            --bg: #fff;
            --accent: #0a7;
            --chip: #eef;
            --chipfg: #045;
            --card: #fff;
            --border: #eee;
        }

        /* Dark scheme */
        @media (prefers-color-scheme: dark) {
            :root {
                --fg: #e8e8e8;
                --muted: #9aa0a6;
                --bg: #0b0f14;
                --accent: #16c4a1;
                --chip: #0f1721;
                --chipfg: #b7fff1;
                --card: #0f141b;
                --border: #1b2330;
            }
        }

        /* Manual override via data-theme on <html> */
        html[data-theme="dark"] {
            --fg: #e8e8e8;
            --muted: #9aa0a6;
            --bg: #0b0f14;
            --accent: #16c4a1;
            --chip: #0f1721;
            --chipfg: #b7fff1;
            --card: #0f141b;
            --border: #1b2330;
        }

        html[data-theme="light"] {
            --fg: #111;
            --muted: #666;
            --bg: #fff;
            --accent: #0a7;
            --chip: #eef;
            --chipfg: #045;
            --card: #fff;
            --border: #eee;
        }

        body {
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
            color: var(--fg);
            background: var(--bg);
            margin: 0;
        }

        .wrap {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        header.hero {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: .75rem 1.25rem;
            margin-bottom: 1.5rem;
        }

        header.hero h1 {
            font-size: 2rem;
            margin: 0;
        }

        nav a {
            text-decoration: none;
            color: var(--fg);
            margin-right: 1rem;
            padding: .4rem .6rem;
            border-radius: .6rem;
        }

        nav a:hover {
            background: color-mix(in oklab, var(--fg) 6%, transparent);
        }

        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: .75rem;
            align-items: center;
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: .75rem;
        }

        .toolbar input[type="search"] {
            flex: 1 1 260px;
            padding: .6rem .8rem;
            border: 1px solid var(--border);
            background: var(--bg);
            color: var(--fg);
            border-radius: 10px;
            font-size: 1rem;
        }

        .toolbar select {
            padding: .55rem .8rem;
            border: 1px solid var(--border);
            background: var(--bg);
            color: var(--fg);
            border-radius: 10px;
        }

        .count {
            color: var(--muted);
            font-size: .95rem;
            margin-left: auto;
        }

        ul.posts {
            list-style: none;
            margin: 1.25rem 0 0;
            padding: 0;
        }

        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 1.1rem 1.25rem;
            margin-bottom: 1rem;
            transition: box-shadow .15s ease, border-color .15s ease, transform .05s ease;
        }

        .card:hover {
            box-shadow: 0 8px 24px rgba(0, 0, 0, .18);
            border-color: color-mix(in oklab, var(--border) 50%, var(--fg) 10%);
            transform: translateY(-1px);
        }

        .card h2 {
            font-size: 1.25rem;
            margin: .1rem 0 .35rem;
        }

        .card h2 a {
            color: var(--fg);
            text-decoration: none;
        }

        .meta {
            color: var(--muted);
            font-size: .9rem;
            display: flex;
            gap: .75rem;
            flex-wrap: wrap;
        }

        .excerpt {
            margin: .6rem 0 0;
            color: color-mix(in oklab, var(--fg) 80%, var(--muted) 20%);
        }

        .chips {
            margin-top: .5rem;
            display: flex;
            flex-wrap: wrap;
            gap: .4rem;
        }

        .chip {
            font-size: .8rem;
            background: var(--chip);
            color: var(--chipfg);
            padding: .18rem .5rem;
            border-radius: 999px;
            cursor: pointer;
            user-select: none;
        }

        .chip.active {
            background: var(--accent);
            color: white;
        }

        .empty {
            text-align: center;
            color: var(--muted);
            padding: 2rem 0;
        }

        footer {
            margin-top: 2rem;
            color: var(--muted);
            font-size: .9rem;
        }

        .spacer {
            flex: 1 1 auto;
        }

        .btn {
            border: 1px solid var(--border);
            background: var(--card);
            color: var(--fg);
            padding: .45rem .7rem;
            border-radius: .6rem;
            cursor: pointer;
        }

        .btn:hover {
            border-color: color-mix(in oklab, var(--border) 30%, var(--fg) 20%);
        }

        @media (max-width:560px) {
            header.hero {
                align-items: flex-start
            }

            .count {
                order: 3;
                width: 100%;
                text-align: right
            }
        }
    </style>
</head>

<body>
    <div class="wrap">

        <!-- Hero / Nav -->
        <header class="hero">
            <h1>P-Dhanush</h1>
            <nav>
                <a href="/">Home</a>
                <a href="/about/">About</a>
                <a href="/projects/">Projects</a>
                <a href="/feed.xml">RSS</a>
            </nav>
            <span class="spacer"></span>
            <button id="themeToggle" class="btn" aria-label="Toggle dark mode">üåì</button>
        </header>

        <!-- Toolbar -->
        <div class="toolbar">
            <input id="q" type="search" placeholder="Search posts (title, excerpt, tags)‚Ä¶" aria-label="Search" />
            <select id="category" aria-label="Filter by category">
                <option value="">All categories</option>
                
                
                
                <option value="notes">notes</option>
                
                
            </select>
            <div class="count"><span id="count"></span></div>
        </div>

        <!-- Posts -->
        <ul id="postList" class="posts">
            
            
            <li class="card" data-title="classes"
                data-excerpt=""
                data-categories=""
                data-tags="">
                <h2><a href="/2025/10/17/classes.html">Classes</a></h2>
                <div class="meta">
                    <span>2025-10-17</span>
                    
                    
                </div>
                <p class="excerpt"></p>
                
            </li>
            
            <li class="card" data-title="structs"
                data-excerpt=""
                data-categories=""
                data-tags="">
                <h2><a href="/2025/10/17/structs.html">Structs</a></h2>
                <div class="meta">
                    <span>2025-10-17</span>
                    
                    
                </div>
                <p class="excerpt"></p>
                
            </li>
            
            <li class="card" data-title="pointers &amp; references"
                data-excerpt=""
                data-categories="notes"
                data-tags="cpp">
                <h2><a href="/notes/2025/10/16/pointers_and-references.html">Pointers & References</a></h2>
                <div class="meta">
                    <span>2025-10-16</span>
                    
                    <span>In: notes</span>
                    
                    
                </div>
                <p class="excerpt"></p>
                
                <div class="chips">
                    
                    <span class="chip" data-chip="cpp">cpp</span>
                    
                </div>
                
            </li>
            
            <li class="card" data-title="cpp learnings"
                data-excerpt=""
                data-categories="notes"
                data-tags="cpp">
                <h2><a href="/notes/2025/10/15/cpplearnings.html">CPP Learnings</a></h2>
                <div class="meta">
                    <span>2025-10-15</span>
                    
                    <span>In: notes</span>
                    
                    
                </div>
                <p class="excerpt"></p>
                
                <div class="chips">
                    
                    <span class="chip" data-chip="cpp">cpp</span>
                    
                </div>
                
            </li>
            
            <li class="card" data-title="c++ object model &amp; raii (ownership, lifetime, memory)"
                data-excerpt=""
                data-categories="notes"
                data-tags="cpp">
                <h2><a href="/notes/2025/10/15/object-model-raii.html">C++ Object Model & RAII (Ownership, Lifetime, Memory)</a></h2>
                <div class="meta">
                    <span>2025-10-15</span>
                    
                    <span>In: notes</span>
                    
                    
                </div>
                <p class="excerpt"></p>
                
                <div class="chips">
                    
                    <span class="chip" data-chip="cpp">cpp</span>
                    
                </div>
                
            </li>
            
            <li class="card" data-title="wsl cheatsheet"
                data-excerpt="a practical, extensible guide to wsl: fundamentals, bash vs powershell, filesystems, networking, performance, daily recipes, and troubleshooting."
                data-categories="notes"
                data-tags="wsl|linux|windows|bash|powershell|dev-setup|jekyll">
                <h2><a href="/notes/2025/10/15/WSLCheatsheet.html">WSL Cheatsheet</a></h2>
                <div class="meta">
                    <span>2025-10-15</span>
                    
                    <span>In: notes</span>
                    
                    
                </div>
                <p class="excerpt">A practical, extensible guide to WSL: fundamentals, Bash vs PowerShell, filesystems, networking, performance, daily recipes, and troubleshooting.</p>
                
                <div class="chips">
                    
                    <span class="chip" data-chip="wsl">wsl</span>
                    
                    <span class="chip" data-chip="linux">linux</span>
                    
                    <span class="chip" data-chip="windows">windows</span>
                    
                    <span class="chip" data-chip="bash">bash</span>
                    
                    <span class="chip" data-chip="powershell">powershell</span>
                    
                    <span class="chip" data-chip="dev-setup">dev-setup</span>
                    
                    <span class="chip" data-chip="jekyll">jekyll</span>
                    
                </div>
                
            </li>
            
            <li class="card" data-title="column store (soa)"
                data-excerpt="crypto l2 analysis: part 1 - column store architecture  crypto l2 analysis: part 1 - column store architecture          workflow                  directory structure          strategy                          obtaining the parameters involved. (read stage)              writing out the parameters per our structure.                                          the actual code used in each file:                  colstore.hpp          ndjson_okx.hpp          okx_to_colstore.cpp                    workflowtaking okx l2 data for btc - usdt in an ndjson format, we convert the file types for faster parsing. since this is market by price and not market by order, we have some limitations with what we can do with the data.you can access the data heretake order book, spot data of depth 400. any one day‚Äôs data would suffice for exploration.to begin with we have two types of actions:  snapshot{&quot;instid&quot;:&quot;btc-usdt&quot;,&quot;action&quot;:&quot;snapshot&quot;,&quot;ts&quot;:&quot;1758326400005&quot;,&quot;asks&quot;:[[&quot;115630.1&quot;,&quot;0.0145523&quot;,&quot;1&quot;],[&quot;115631.0&quot;,&quot;0.0539&quot;,&quot;1&quot;]...],&quot;bids:[[px,qty,cnt],...[px,qty,cnt]]}  update{&quot;instid&quot;:&quot;btc-usdt&quot;,&quot;action&quot;:&quot;update&quot;,&quot;ts&quot;:&quot;1758326400015&quot;,&quot;asks&quot;:[[&quot;115717.8&quot;,&quot;0.18242079&quot;,&quot;6&quot;]],&quot;bids&quot;:[]}for this stage of our implementation we focussing on converting the data into this structure:-    // a minimal, append-only columnar store with separate binary files per column.    // layout:    //   outdir/    //     schema.json              (human readable schema)    //     columns/    //       frame.u64    //       ts_ms.u64                 (uint64 little-endian, ms since epoch)    //       side.u8                (0 = bid, 1 = ask)    //       etype.u8               (0 = snap, 1 = add, 2 = modify,3 = del, 4 = clear_bids, 5 = clear_asks)    //       level.u16              (0..n-1 within that frame)    //       px.f64                 (double price)    //       qty.f64                (double size, amt. actually held)    //       count.u32              (count, number of orders)    //       inst_id.txt            (one line: instrument name)    //     footer.json              ({&quot;rows&quot;: &amp;lt;n&amp;gt;})    // all files are append-only; caller is responsible for writing a consistent number of rows across columns.directory structureinclude -||__mercury // (i named my project mercury)| || |__colstore.hpp| |__ndjson_okx.hpp||__src| |__colstore_inspect.cpp| |__okx_to_colstore.cppstrategyobtaining the parameters involved. (read stage)        ----------------------       |                      |     ---|       parser         |    |  |----------------------|    |    |  |- (px,qty,cnt) tuple -&amp;gt; [obtain parameters via parser function]     |--|- (px,qty,cnt) tuple -&amp;gt; [obtain parameters via parser function]    |  |- (px,qty,cnt) tuple -&amp;gt; [obtain parameters via parser function]    |     |  |- (px,qty,cnt) tuple -&amp;gt; [obtain parameters via parser function]    |--|- (px,qty,cnt) tuple -&amp;gt; [obtain parameters via parser function]       |- (px,qty,cnt) tuple -&amp;gt; [obtain parameters via parser function]to keep in mind the possibility of a dynamic use-case of the parameters we obtain, we dont hardcode what we do with the obtained parameters in the parser function itself. instead we send a lambda function in the parser function.// the parse function structure in the header file -&amp;gt;template &amp;lt;class f&amp;gt;inline void parse_okx_ndjson(const std::string &amp;amp;path, f &amp;amp;&amp;amp;on_record){...}// the parse function we call -&amp;gt;mercury::parse_okx_ndjson(in_path,         [&amp;amp;](uint64_t ts_ms, uint8_t side, uint16_t level, double px, double qty, uint32_t count)        {            // skip empty quantities (deletes will appear as qty=0 in some datasets)            if (qty &amp;lt;= 0.0)                return;            writer.append(frame, ts_ms, side, level, px, qty, count);            ++emitted;            if ((emitted % 1&#39;000&#39;000) == 0)            {                cerr &amp;lt;&amp;lt; &quot;‚Ä¶ &quot; &amp;lt;&amp;lt; emitted &amp;lt;&amp;lt; &quot; rows written\n&quot;;            }         }        );        writer.close();        cout &amp;lt;&amp;lt; &quot;wrote &quot; &amp;lt;&amp;lt; writer.rows() &amp;lt;&amp;lt; &quot; rows to &quot; &amp;lt;&amp;lt; outdir &amp;lt;&amp;lt; &quot;\n&quot;;writing out the parameters per our structure.the writer function seen above is to write the parameters we obtain down into our files.  we configure a path where we can create our output columns.  create a colwriter class with an apt constructor to open files on initilaizing. this can bring down overhead.  we then use functions to write the parameters we‚Äôve extracted into these files. the lambda funciton earlier takes care of this. we simply provide an apt append funciton to aid this process.struct files{  std::file *frame = nullptr;  std::file *ts_ms = nullptr;  std::file *side = nullptr;  std::file *level = nullptr;  std::file *px = nullptr;  std::file *qty = nullptr;  std::file *count = nullptr;  fs::path dir;  uint64_t rows = 0;}class colwriter{  public:    // the constructor function will open up all the files.    explicit colwriter(filestream::path outdir, ) -&amp;gt; outdir_(sd::move(outdir)){      check_directory_present(outdir); // if not the func will take care of creating.      auto cols = outdir_ / &quot;columns&quot;;      check_directory_present(cols);      files_.dir = outdir_;      files_.frame = open_or_throw(cols / &quot;frame.u64&quot;);      files_.ts_ms = open_or_throw(cols / &quot;ts_ms.u64&quot;);      files_.side = open_or_throw(cols / &quot;side.u8&quot;);      // you get the idea.. (open all similarly, leaving for brevity)      }    ~colwriter{      close();    }    colwriter(const colwriter &amp;amp;) = delete;    colwriter &amp;amp;operator=(const colwriter &amp;amp;) = delete;    void append(uint64_t frame, uint64_t ts_ms, uint8_t side, uint16_t level, double px, double qty, uint32_t count){      write_scalar(files_.frame, frame);      write_scalar(files_.ts_ms, ts_ms);      // so on..    }    void safe_close(std::file*&amp;amp; f){ // a reference to the pointer. we want to set caller&#39;s pointer varaible to nullptr, so we can&#39;t let the pointer be passed by value and need actual pointer.        if(f){          std::fclose(f);          f = nullptr;        }    }    void close(){      if(closed_){        return;      }      safe_close(files_.frame);      safe_close(files_.ts_ms);      //so on..    }  private:    filestream::path outdir_;    files files_{};}the actual code used in each file:colstore.hpp#ifndef mercury_colstore_hpp#define mercury_colstore_hpp#include &amp;lt;cstdint&amp;gt;#include &amp;lt;cstdio&amp;gt;#include &amp;lt;cstring&amp;gt;#include &amp;lt;string&amp;gt;#include &amp;lt;string_view&amp;gt;#include &amp;lt;vector&amp;gt;#include &amp;lt;filesystem&amp;gt;namespace fs = std::filesystem;#include &amp;lt;stdexcept&amp;gt;#include &amp;lt;memory&amp;gt;#include &amp;lt;system_error&amp;gt;#include &amp;lt;optional&amp;gt;#include &amp;lt;fstream&amp;gt;namespace mercury{    struct colfiles    {        std::file *frame = nullptr;        std::file *ts_ms = nullptr;        std::file *side = nullptr;        std::file *level = nullptr;        std::file *px = nullptr;        std::file *qty = nullptr;        std::file *count = nullptr;        fs::path dir;        uint64_t rows = 0;    };    inline void ensure_dir(const fs::path &amp;amp;p)    {        std::error_code ec;        if (!fs::exists(p) &amp;amp;&amp;amp; !fs::create_directories(p, ec))        {            throw std::runtime_error(&quot;failed to create directory: &quot; + p.string() + &quot;, error: &quot; + ec.message());        }    }    inline std::file *open_or_throw(const fs::path &amp;amp;p)    {        auto f = std::fopen(p.string().c_str(), &quot;wb&quot;);        if (!f)            throw std::runtime_error(&quot;failed to open for write: &quot; + p.string());        return f;    }    class colwriter    {    public:        explicit colwriter(fs::path outdir, std::string_view inst_id)            : outdir_(std::move(outdir))        {            if (inst_id.empty())                throw std::invalid_argument(&quot;inst_id is empty&quot;);            // dirs            ensure_dir(outdir_);            auto cols = outdir_ / &quot;columns&quot;;            ensure_dir(cols);            // schema            {                std::ofstream s(outdir_ / &quot;schema.json&quot;, std::ios::binary);                s &amp;lt;&amp;lt; &quot;{&quot;                     &quot;\&quot;version\&quot;: 1,&quot;                     &quot;\&quot;columns\&quot;: [&quot;                     &quot;{\&quot;name\&quot;: \&quot;frame\&quot;,   \&quot;type\&quot;: \&quot;u64\&quot;, \&quot;unit\&quot;: \&quot;integer - a count\&quot;},&quot;                     &quot;{\&quot;name\&quot;: \&quot;ts_ms\&quot;,   \&quot;type\&quot;: \&quot;u64\&quot;, \&quot;unit\&quot;: \&quot;ns\&quot;},&quot;                     &quot;{\&quot;name\&quot;: \&quot;side\&quot;, \&quot;type\&quot;: \&quot;u8\&quot;,  \&quot;desc\&quot;: \&quot;0=bid,1=ask\&quot;},&quot;                     &quot;{\&quot;name\&quot;: \&quot;level\&quot;,\&quot;type\&quot;: \&quot;u16\&quot;},&quot;                     &quot;{\&quot;name\&quot;: \&quot;px\&quot;,   \&quot;type\&quot;: \&quot;f64\&quot;},&quot;                     &quot;{\&quot;name\&quot;: \&quot;qty\&quot;,  \&quot;type\&quot;: \&quot;f64\&quot;},&quot;                     &quot;{\&quot;name\&quot;: \&quot;count\&quot;,  \&quot;type\&quot;: \&quot;u32\&quot;, \&quot;desc\&quot;: \&quot;number of orders\&quot;}&quot;                     &quot;]&quot;                     &quot;}&quot;;            }            // inst id            {                std::ofstream idf(cols / &quot;inst_id.txt&quot;, std::ios::binary);                idf &amp;lt;&amp;lt; inst_id;            }            files_.dir = outdir_;            files_.frame = open_or_throw(cols / &quot;frame.u64&quot;);            files_.ts_ms = open_or_throw(cols / &quot;ts_ms.u64&quot;);            files_.side = open_or_throw(cols / &quot;side.u8&quot;);            files_.level = open_or_throw(cols / &quot;level.u16&quot;);            files_.px = open_or_throw(cols / &quot;px.f64&quot;);            files_.qty = open_or_throw(cols / &quot;qty.f64&quot;);            files_.count = open_or_throw(cols / &quot;count.u32&quot;);        }        ~colwriter()        {            close();        }        colwriter(const colwriter &amp;amp;) = delete;        colwriter &amp;amp;operator=(const colwriter &amp;amp;) = delete;        void append(uint64_t frame, uint64_t ts_ms, uint8_t side, uint16_t level, double px, double qty, uint32_t count)        {            write_scalar(files_.frame, frame);            write_scalar(files_.ts_ms, ts_ms);            write_scalar(files_.side, side);            write_scalar(files_.level, level);            write_scalar(files_.px, px);            write_scalar(files_.qty, qty);            write_scalar(files_.count, count);            ++files_.rows;        }        void safe_close(std::file *&amp;amp;f)        {            if (f)            {                std::fclose(f);                f = nullptr;            }        }        void close()        {            if (closed_)                return;            safe_close(files_.frame);            safe_close(files_.ts_ms);            safe_close(files_.side);            safe_close(files_.level);            safe_close(files_.px);            safe_close(files_.qty);            safe_close(files_.count);            // footer            try            {                std::ofstream f(outdir_ / &quot;footer.json&quot;, std::ios::binary);                f &amp;lt;&amp;lt; &quot;{\&quot;rows\&quot;: &quot; &amp;lt;&amp;lt; files_.rows &amp;lt;&amp;lt; &quot;}&quot;;            }            catch (...)            {            }            closed_ = true;        }        uint64_t rows() const { return files_.rows; }    private:        template &amp;lt;class t&amp;gt;        static void write_scalar(std::file *f, const t &amp;amp;v)        {            if (std::fwrite(&amp;amp;v, sizeof(t), 1, f) != 1)            {                throw std::runtime_error(&quot;colstore write failed&quot;);            }        }        fs::path outdir_;        colfiles files_{};        bool closed_ = false;    };#ifdef _win32#include &amp;lt;windows.h&amp;gt;#else#include &amp;lt;sys/mman.h&amp;gt;#include &amp;lt;fcntl.h&amp;gt;#include &amp;lt;unistd.h&amp;gt;#endif    struct mmap    {        uint8_t *ptr = nullptr;        size_t len = 0;        static mmap map(const fs::path &amp;amp;p)        {            mmap m;            // portable fallback: read whole file into memory (fast enough for inspection)            std::ifstream in(p, std::ios::binary);            if (!in)                throw std::runtime_error(&quot;open failed: &quot; + p.string());            in.seekg(0, std::ios::end);            m.len = static_cast&amp;lt;size_t&amp;gt;(in.tellg());            in.seekg(0);            m.ptr = static_cast&amp;lt;uint8_t *&amp;gt;(std::malloc(m.len));            if (!m.ptr)                throw std::bad_alloc();            in.read(reinterpret_cast&amp;lt;char *&amp;gt;(m.ptr), m.len);            return m;        }        void unmap()        {            if (ptr)            {                std::free(ptr);                ptr = nullptr;                len = 0;            }        }    };} // namespace mercury#endif // mercury_colstore_hppndjson_okx.hpp#ifndef mercury_ndjson_okx_hpp#define mercury_ndjson_okx_hpp#include &amp;lt;string&amp;gt;#include &amp;lt;string_view&amp;gt;#include &amp;lt;cstdint&amp;gt;#include &amp;lt;stdexcept&amp;gt;#include &amp;lt;simdjson.h&amp;gt;namespace mercury{    // one json line -&amp;gt; many rows (one per tuple in bids/asks).    // on_record signature expected: void(uint64_t ts_ms, uint8_t side, uint16_t level,    ///                                   double px, double qty, uint32_t count)    template &amp;lt;class f1, class f2&amp;gt;    inline void parse_okx_ndjson(const std::string &amp;amp;path, f1 &amp;amp;&amp;amp;on_record, f2 &amp;amp;frame_id, uint64_t &amp;amp;row_limit)    {        using namespace simdjson;        bool continue_parsing = true;        ondemand::parser parser;        auto doc_result = padded_string::load(path);        if (doc_result.error())        {            throw std::runtime_error(&quot;failed to load file: &quot; + path);        }        padded_string &amp;amp;doc = doc_result.value();        uint64_t emitted = 0;        auto stream_res = parser.iterate_many(doc);        ondemand::document_stream stream = std::move(stream_res).value();        for (simdjson::ondemand::document_reference d : stream)        {            frame_id++; // &amp;lt;- increment per json line            if (d.type().value() != simdjson::ondemand::json_type::object)                continue;            auto obj = d.get_object().value();            // ts may be string or number (okx gives ms)            uint64_t ts_ms = 0;            if (auto ts_it = obj.find_field_unordered(&quot;ts&quot;); ts_it.error() == success)            {                auto v = ts_it.value();                if (v.type().value() == ondemand::json_type::string)                {                    std::string s = std::string(v.get_string().value());                    ts_ms = static_cast&amp;lt;uint64_t&amp;gt;(std::strtoull(s.c_str(), nullptr, 10));                }                else                {                    ts_ms = uint64_t(v.get_uint64().value());                }            }            auto maybe_stop = [&amp;amp;](void) -&amp;gt; bool            {                if (row_limit == 0)                    return false;                return emitted &amp;gt;= row_limit;            };            // helper: emit one row per [px, qty, count?] tuple            auto push_side = [&amp;amp;](ondemand::value arr_val, uint8_t side)            {                if (arr_val.type().value() != ondemand::json_type::array)                    return;                ondemand::array arr = arr_val.get_array().value();                uint16_t level = 0;                for (auto lvl_res : arr)                {                    ondemand::value lvl_v = lvl_res.value();                    if (lvl_v.type().value() != ondemand::json_type::array)                    {                        ++level;                        continue;                    }                    ondemand::array triple = lvl_v.get_array().value();                    double px = 0.0;                    double qty = 0.0;                    uint32_t count = 0;                     size_t idx = 0;                    for (auto c_res : triple)                    {                        auto c = c_res.value();                        if (idx == 0)                        {                            if (c.type().value() == ondemand::json_type::string)                            {                                std::string s = std::string(c.get_string().value());                                px = std::strtod(s.c_str(), nullptr);                            }                            else                            {                                px = double(c.get_double().value());                            }                        }                        else if (idx == 1)                        {                            if (c.type().value() == ondemand::json_type::string)                            {                                std::string s = std::string(c.get_string().value());                                qty = std::strtod(s.c_str(), nullptr);                            }                            else                            {                                qty = double(c.get_double().value());                            }                        }                        else if (idx == 2)                        {                            if (c.type().value() == ondemand::json_type::string)                            {                                std::string s = std::string(c.get_string().value());                                count = static_cast&amp;lt;uint32_t&amp;gt;(std::strtoul(s.c_str(), nullptr, 10));                            }                            else                            {                                // some venues encode counts as integers but ondemand lets us fetch as uint64                                count = static_cast&amp;lt;uint32_t&amp;gt;(c.get_uint64().value());                            }                        }                        ++idx;                    }                    on_record(ts_ms, side, level, px, qty, count);                    if (maybe_stop())                    {                        continue_parsing = false;                        break;                    }                    ++level;                    ++emitted;                }            };            // bids / b            if (auto it = obj.find_field_unordered(&quot;bids&quot;); it.error() == success)            {                push_side(it.value(), /*side=*/0);            }            else if (auto it2 = obj.find_field_unordered(&quot;b&quot;); it2.error() == success)            {                push_side(it2.value(), /*side=*/0);            }            // asks / a            if (auto it = obj.find_field_unordered(&quot;asks&quot;); it.error() == success)            {                push_side(it.value(), /*side=*/1);            }            else if (auto it2 = obj.find_field_unordered(&quot;a&quot;); it2.error() == success)            {                push_side(it2.value(), /*side=*/1);            }            if (!continue_parsing)            {                break;            }        }    }} // namespace mercury#endif // mercury_ndjson_okx_hppokx_to_colstore.cpp#include &amp;lt;iostream&amp;gt;#include &amp;lt;filesystem&amp;gt;#include &amp;lt;string&amp;gt;#include &amp;lt;string_view&amp;gt;#include &amp;lt;cstdlib&amp;gt;#include &amp;lt;simdjson.h&amp;gt;#include &quot;mercury/colstore.hpp&quot;#include &quot;mercury/ndjson_okx.hpp&quot;using namespace std;int main(int argc, char **argv){    if (argc &amp;lt; 4)    {        cerr &amp;lt;&amp;lt; &quot;usage: okx_to_colstore &amp;lt;input.data&amp;gt; &amp;lt;out_dir&amp;gt; &amp;lt;instid&amp;gt;\n&quot;;        cerr &amp;lt;&amp;lt; &quot;example: okx_to_colstore btc-usdt-l2orderbook-400lv-2025-09-20.data out/btc-usdt btc-usdt\n&quot;;        return 1;    }    const string in_path = argv[1];    const filesystem::path outdir = argv[2];    const string inst_id = argv[3];    uint64_t row_limit = 0;    if (argc &amp;gt;= 5)    {        row_limit = std::strtoull(argv[4], nullptr, 10);    }    try    {        mercury::colwriter writer(outdir, inst_id);        size_t emitted = 0;        uint64_t frame = 0;        mercury::parse_okx_ndjson(in_path, [&amp;amp;](uint64_t ts_ms, uint8_t side, uint16_t level, double px, double qty, uint32_t count)                                  {                                      if (qty &amp;lt;= 0.0)                                          return;                                      writer.append(frame, ts_ms, side, level, px, qty, count);                                      ++emitted;                                      if ((emitted % 1&#39;000&#39;000) == 0)                                      {                                          cerr &amp;lt;&amp;lt; &quot;‚Ä¶ &quot; &amp;lt;&amp;lt; emitted &amp;lt;&amp;lt; &quot; rows written\n&quot;;                                      } }, frame, row_limit);        writer.close();        cout &amp;lt;&amp;lt; &quot;wrote &quot; &amp;lt;&amp;lt; writer.rows() &amp;lt;&amp;lt; &quot; rows to &quot; &amp;lt;&amp;lt; outdir &amp;lt;&amp;lt; &quot;\n&quot;;    }    catch (const std::exception &amp;amp;e)    {        cerr &amp;lt;&amp;lt; &quot;error: &quot; &amp;lt;&amp;lt; e.what() &amp;lt;&amp;lt; &quot;\n&quot;;        return 2;    }    return 0;}"
                data-categories="notes"
                data-tags="jekyll|howto">
                <h2><a href="/notes/2025/10/15/Column-Store-(SoA).html">Column Store (SoA)</a></h2>
                <div class="meta">
                    <span>2025-10-15</span>
                    
                    <span>In: notes</span>
                    
                    
                </div>
                <p class="excerpt">Crypto L2 Analysis: Part 1 - Column Store Architecture  Crypto L2 Analysis: Part 1 - Column Store Architecture          Workflow                  Directory Structure          Strategy                          Obtainin...</p>
                
                <div class="chips">
                    
                    <span class="chip" data-chip="jekyll">jekyll</span>
                    
                    <span class="chip" data-chip="howto">howto</span>
                    
                </div>
                
            </li>
            
            <li class="card" data-title="wsl"
                data-excerpt="title: ‚Äúwsl notes‚Äùdescription: ‚Äúa living document of how wsl and practical tips to use it.‚Äùlast_updated: 2025-10-15tags: [wsl, linux, windows, bash, powershell, dev-setup]‚Äîwsl notes  a structured, evolving reference for understanding wsl (windows subsystem for linux) from fundamentals to daily workflows, including bash vs powershell, wsl1 vs wsl2, filesystem interop, networking, performance, automation, and common recipes.table of contents  1. first principles          1.1 what is an os, kernel, and userspace?      1.2 where wsl fits in      1.3 wsl1 vs wsl2        2. shells &amp;amp; environments          2.1 bash (linux) vs powershell (windows)      2.2 profiles: .bashrc, .profile, powershell profiles      2.3 environment variables        3. filesystems &amp;amp; paths          3.1 wsl filesystem vs windows drives      3.2 performance &amp;amp; file-watching      3.3 line endings &amp;amp; permissions        4. processes, networking, interop          4.1 running windows apps from wsl &amp;amp; vice versa      4.2 networking model      4.3 clipboard &amp;amp; file association tips        5. package managers &amp;amp; toolchains          5.1 apt vs winget/choco      5.2 compilers, build tools, python, node, ruby        6. git &amp;amp; projects          6.1 where to clone projects      6.2 git config &amp;amp; crlf handling        7. daily recipes (copy-paste friendly)  8. troubleshooting &amp;amp; diagnostics  9. security &amp;amp; backups  10. comparative analysis (quick reference)  11. glossary  12. further reading  appendix a: personal setup checklists  appendix b: snippets1. first principles1.1 what is an os, kernel, and userspace?  kernel: manages hardware, processes, memory, filesystems, networking.  userspace: shells, tools, libraries, apps.  linux vs windows: different kernels ‚Üí different system calls &amp;amp; tooling.  add notes/examples:      example: strace (linux) vs process monitor (windows)    syscalls vs win32 apis  1.2 where wsl fits in  wsl = run a linux userspace on windows.  wsl1: syscall translation layer ‚Üí linux syscalls translated to windows kernel calls.  wsl2: lightweight vm running a real linux kernel ‚Üí higher compatibility/perf, different networking/filesystem behavior.1.3 wsl1 vs wsl2| aspect | wsl1 | wsl2 ||‚Äî|‚Äî|‚Äî|| kernel | translation layer | real linux kernel (in a managed vm) || fs perf (linux home) | n/a | fast || fs perf (/mnt/c/...) | generally fast | slower; use for access, not hot dev || inotify/file watch | bridged | native in linux fs; flaky on /mnt/* || networking | shares host ip | nat/virtualized; different ip || compatibility | good, not perfect | very high |  choose wsl2 for most dev. keep repos in ~/ (linux fs). use /mnt/* for occasional access to windows files.2. shells &amp;amp; environments2.1 bash (linux) vs powershell (windows)| topic | bash | powershell ||‚Äî|‚Äî|‚Äî|| prompt style | $ | ps c:\&amp;gt; || scripting | #!/usr/bin/env bash | .ps1, powershell syntax || env var set | foo=bar cmd or export foo=bar | $env:foo=&#39;bar&#39;; cmd || path sep | /home/user | c:\users\user || pipe objects? | text streams | .net objects |  use bash inside wsl for linux tooling &amp;amp; package managers; powershell for windows-side automation.2.2 profiles: .bashrc, .profile, powershell profiles  ~/.bashrc: runs for interactive bash shells; good for aliases, exports.  ~/.profile / ~/.bash_profile: login shell config.  powershell profile: see $profile for path; customize aliases &amp;amp; functions.common bash additions:```bash~/.bashrcexport gem_home=‚Äù$home/.gems‚Äùexport path=‚Äù$home/.gems/bin:$path‚Äùalias ll=‚Äôls -lah‚Äôalias jserve=‚Äôbundle exec jekyll serve ‚Äìlivereload ‚Äìdrafts ‚Äìfuture ‚Äìforce_polling‚Äô"
                data-categories="notes"
                data-tags="jekyll|howto">
                <h2><a href="/notes/2025/10/15/WSL.html">WSL</a></h2>
                <div class="meta">
                    <span>2025-10-15</span>
                    
                    <span>In: notes</span>
                    
                    
                </div>
                <p class="excerpt">title: ‚ÄúWSL Notes‚Äùdescription: ‚ÄúA living document of how WSL and practical tips to use it.‚Äùlast_updated: 2025-10-15tags: [wsl, linux, windows, bash, powershell, dev-setup]‚ÄîWSL Notes  A structured, evolving reference f...</p>
                
                <div class="chips">
                    
                    <span class="chip" data-chip="jekyll">jekyll</span>
                    
                    <span class="chip" data-chip="howto">howto</span>
                    
                </div>
                
            </li>
            
            <li class="card" data-title="testing all the features"
                data-excerpt="my first post: a feature testthis post is a demonstration of all the formatting capabilities available in a github pages blog using jekyll and markdown. we will cover everything from basic text formatting to advanced embeds.this text is bold and this text is italic. it‚Äôs easy to add emphasis wherever you need it.lists and organizationsometimes you need to organize information into lists.an unordered list:  item one  item two          a nested item        item threean ordered list:  first, we do this.  second, we do that.  finally, we are done.adding imagesyes, you can absolutely add an image. first, upload the image file to your repository (a good practice is to create an assets/images folder). then, link to it like this:displaying code snippetsdisplaying code is crucial for a technical blog. here is a sample python function with proper syntax highlighting.# a simple function to greet a userdef greet(name):  &quot;&quot;&quot;this function takes a name and prints a greeting.&quot;&quot;&quot;  print(f&quot;hello, {name}! welcome to the blog.&quot;)# let&#39;s call the functiongreet(&quot;world&quot;)embedding an interactive datawrapper chart"
                data-categories="notes"
                data-tags="jekyll|howto">
                <h2><a href="/notes/2015/10/13/my-feature-test.html">Testing All The Features</a></h2>
                <div class="meta">
                    <span>2015-10-13</span>
                    
                    <span>In: notes</span>
                    
                    
                </div>
                <p class="excerpt">My First Post: A Feature TestThis post is a demonstration of all the formatting capabilities available in a GitHub Pages blog using Jekyll and Markdown. We will cover everything from basic text formatting to advanced ...</p>
                
                <div class="chips">
                    
                    <span class="chip" data-chip="jekyll">jekyll</span>
                    
                    <span class="chip" data-chip="howto">howto</span>
                    
                </div>
                
            </li>
            
        </ul>

        <div id="empty" class="empty" style="display:none;">No posts match your filters.</div>

        <footer>
            <p>&copy; 2025 P-Dhanush ¬∑ Powered by
                Jekyll (Minima).</p>
        </footer>
    </div>

    <script>
        (function () {
            // THEME
            const html = document.documentElement;
            const btn = document.getElementById('themeToggle');
            const saved = localStorage.getItem('theme'); // 'light' | 'dark' | null
            if (saved === 'light' || saved === 'dark') html.setAttribute('data-theme', saved);

            btn.addEventListener('click', () => {
                const cur = html.getAttribute('data-theme') || 'auto';
                const next = (cur === 'dark') ? 'light' : 'dark';
                html.setAttribute('data-theme', next);
                localStorage.setItem('theme', next);
            });

            // FILTERS
            const q = document.getElementById('q');
            const category = document.getElementById('category');
            const list = document.getElementById('postList');
            const cards = Array.from(list.querySelectorAll('.card'));
            const count = document.getElementById('count');
            const empty = document.getElementById('empty');

            let tagFilter = "";

            // Delegate chip clicks
            list.addEventListener('click', (e) => {
                const el = e.target.closest('.chip');
                if (!el) return;
                const t = (el.dataset.chip || "").toLowerCase();
                tagFilter = (tagFilter === t) ? "" : t;
                list.querySelectorAll('.chip').forEach(c => c.classList.toggle('active', (c.dataset.chip || "").toLowerCase() === tagFilter && tagFilter !== ""));
                apply();
            });

            q.addEventListener('input', apply);
            category.addEventListener('change', apply);

            function apply() {
                const needle = (q.value || "").trim().toLowerCase();
                const cat = (category.value || "").toLowerCase();

                let visible = 0;
                cards.forEach(card => {
                    const title = card.dataset.title;
                    const excerpt = card.dataset.excerpt;
                    const cats = card.dataset.categories || "";
                    const tags = card.dataset.tags || "";

                    const textOk = !needle || title.includes(needle) || excerpt.includes(needle) || tags.includes(needle);
                    const catOk = !cat || cats.split('|').includes(cat);
                    const tagOk = !tagFilter || tags.split('|').includes(tagFilter);

                    const show = textOk && catOk && tagOk;
                    card.style.display = show ? "" : "none";
                    if (show) visible++;
                });

                count.textContent = visible + " post" + (visible === 1 ? "" : "s");
                empty.style.display = visible ? "none" : "";
            }

            apply();
        })();
    </script>
</body>

</html>
      
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 <a href="https://p-dhanush.github.io">P-Dhanush</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>









  </body>
</html>
